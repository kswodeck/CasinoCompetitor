<%- include('partials/header') %>

<div id="mid-container">
    <h1 id="page-heading" class="mb-md-3 mb-sm-2 mb-1"><span id="leaderboard-span">Competitive Poker</span><br />Leaderboard</h1>
    <div id="leaderboard-div" class="container-fluid">
      <table id ="leaderboard-table">
        <thead id ="leaderboard-heading">
          <tr id="table-search-row">
            <th id="table-search-cell" class ="leaderboard-cell" colspan="4" scope="colgroup">
              <form action="#" onsubmit="searchLeaderboard();return false">
                <button id="search-button" class="btn" name="search-submit" type="submit" onclick="restoreLeaderboard()"><i id="table-search-icon" class="fas fa-search"></i></button>
                <input type="search" id="tableSearch" class="table-search" name="table-search" size="21" maxlength="20" placeholder="search by username..." incremental>
              </form>
            </th>
          </tr>
        </thead>
        <tbody id ="leaderboard-body">
          <tr id="leaderboard-head-row">
            <td class="leaderboard-head">Rank</td>
            <td class="leaderboard-head">Username</td>
            <td class="leaderboard-head">Highest Win</td>
            <td class="leaderboard-head">Total Coins</td>
          </tr>
          <!-- must delete all kswodecks, duplicates and such after going live -->
          <% let numPages = 1, currentRank = 1, rowsPerPage = 200, totalRows = 1 %>
          <% users.forEach(function(user){ %>
            <tr class ="leaderboard-row normal-row">
              <td class ="leaderboard-cell leaderboard-rank"><%= currentRank %></td>
              <td class ="leaderboard-cell leaderboard-username"><%= user.username %></td>
              <td class ="leaderboard-cell leaderboard-highest"><%= user.highestWin %></td>
              <td class ="leaderboard-cell leaderboard-coins"><%= user.coins %></td>
            </tr>
            <% currentRank++; %>
            <% totalRows++; %>
        <% }); %>
        </tbody>
      </table>
        <% if (numPages >= 2 ) { %>
        <nav id="leaderboard-pagination" aria-label="Page navigation">
          <ul id="pagination-list" class="pagination">
            <li class="page-item">
              <a class="page-link" href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
            <li class="page-item"><a class="page-link" href="#"><%= numPages %></a></li>
            <% while (numPages*rowsPerPage < totalRows ) { %>
              <li class="page-item"><a class="page-link" href="#"><%= numPages %></a></li>
            <% numPages++; %>
            <% } %>
            <li class="page-item">
              <a class="page-link" href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
          </ul>
        </nav>
        <% } %>
    </div>
</div>

<%- include('partials/logindialogs') %>
<%- include('partials/footer') %>
<script src="\javascripts\vue\dist\vue.min.js"></script>
<script src="\javascripts\leaderboard.js" type="text/javascript" ></script>
<%- include('partials/javascripts') %>